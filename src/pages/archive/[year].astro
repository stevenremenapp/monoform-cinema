---
import Layout from "../../layouts/Layout.astro";
import Footer from "../../components/Footer.astro";
import PlayingNextMarquee from "../../components/PlayingNextMarquee.astro";
import Header from "../../components/Header.astro";
import SectionHeader from "../../components/SectionHeader.astro";
import NewsletterMarquee from "../../components/NewsletterMarquee.astro";
import ScreeningDetails from "../../components/ScreeningDetails.astro";
import ArchiveNavigation from "../../components/ArchiveNavigation.astro";
import shows_2024 from "../../data/schedules/2024-season-1.json";
import shows_2025 from "../../data/schedules/2025-season-2.json";

interface Show {
    eventMonth: string;
    eventDate: Array<string>;
    eventLocation: string;
    eventTime: string;
    eventTitle: string;
    bannerImageUrl: string;
    trailerUrl: string;
    ticketsUrl: Array<{ dateString: string; url: string; isSoldOut?: boolean }>;
    description: string;
    films: Array<{
        title: string;
        year: string;
        runtime: string;
        director: Array<string>;
        writer: Array<string>;
        cast: Array<string>;
        composer: Array<string>;
    }>;
    additionalInfo: string;
    sticker?: Record<"url" | "altText" | "className", string>;
}

export async function getStaticPaths() {
    return [{ params: { year: "2025" } }, { params: { year: "2024" } }];
}

const { year } = Astro.params;

const showsByYear: Record<string, Show[]> = {
    "2024": shows_2024,
    "2025": shows_2025,
};

const shows = showsByYear[year as string] || [];
---

<Layout
    title="Monoform Cinema | Kalamazoo, MI"
    description="Kalamazoo's new pop-up micro-cinema. Come to our monthly shows, every second Thursday at The Dormouse Theatre."
>
    <Header />
    <PlayingNextMarquee />
    <main>
        <div class="archive-intro">
            <SectionHeader title="The Archive" />
            <p class="season-details">
                Thank you to everyone who has attended and shared our shows so
                far! Below is an archive of all the past shows we've hosted. We
                look forward to seeing you at upcoming shows; please see <a
                    href="/#upcoming-shows">our current schedule here</a
                >!
            </p>
            <ArchiveNavigation />
            <SectionHeader title={`${year} Shows`} />
        </div>
        <div class="shows-list">
            {shows.map((show: Show) => <ScreeningDetails {...show} />)}
        </div>
        <div class="bottom-archive-nav">
            <ArchiveNavigation />
            <p>
                Or see <a href="/#upcoming-shows">our current schedule here</a>!
            </p>
        </div>
    </main>
    <NewsletterMarquee />
    <Footer />
</Layout>

<style>
    main {
        margin-top: 80px;
    }

    main a {
        color: var(--base-light);
    }

    :global(.shows-list .screening-container:last-child) {
        margin-bottom: 0;
    }

    .archive-intro {
        margin-bottom: 70px;
    }

    .bottom-archive-nav {
        margin-top: 35px;
        margin-bottom: 40px;
    }
</style>
